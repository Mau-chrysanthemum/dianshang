(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["AddGoods"],{"90dd":function(e,t,a){},a870:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"title"},[e._v("添加商品信息")]),a("el-steps",{attrs:{space:200,active:e.active,"finish-status":"success"}},[a("el-step",{attrs:{title:"步骤 1"}}),a("el-step",{attrs:{title:"步骤 2"}}),a("el-step",{attrs:{title:"步骤 3"}}),a("el-step",{attrs:{title:"步骤 4"}}),a("el-step",{attrs:{title:"步骤 5"}})],1),a("el-form",{ref:"addGoodsForm",attrs:{model:e.goodsObj,rules:e.rules,"label-width":"150px"}},[a("el-tabs",{attrs:{value:"base","tab-position":"left"},on:{"tab-click":e.tabClick}},[a("el-tab-pane",{attrs:{name:"base",label:"基本信息"}},[a("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[a("el-input",{model:{value:e.goodsObj.goods_name,callback:function(t){e.$set(e.goodsObj,"goods_name",t)},expression:"goodsObj.goods_name"}})],1),a("el-form-item",{attrs:{label:"商品价格",prop:"goods_price"}},[a("el-input",{model:{value:e.goodsObj.goods_price,callback:function(t){e.$set(e.goodsObj,"goods_price",t)},expression:"goodsObj.goods_price"}})],1),a("el-form-item",{attrs:{label:"商品数量",prop:"goods_number"}},[a("el-input",{model:{value:e.goodsObj.goods_number,callback:function(t){e.$set(e.goodsObj,"goods_number",t)},expression:"goodsObj.goods_number"}})],1),a("el-form-item",{attrs:{label:"商品分类",prop:"goods_cat"}},[a("el-cascader",{attrs:{props:e.props,"show-all-levels":!1,options:e.options},on:{change:e.categoryChange}})],1),a("el-form-item",{attrs:{label:"是否促销"}},[a("el-radio",{attrs:{label:1,border:""},model:{value:e.goodsObj.is_promote,callback:function(t){e.$set(e.goodsObj,"is_promote",t)},expression:"goodsObj.is_promote"}},[e._v("是")]),a("el-radio",{attrs:{label:0,border:""},model:{value:e.goodsObj.is_promote,callback:function(t){e.$set(e.goodsObj,"is_promote",t)},expression:"goodsObj.is_promote"}},[e._v("否")])],1)],1),a("el-tab-pane",{attrs:{name:"params",label:"商品参数"}},e._l(e.dparams,function(t){return a("el-form-item",{key:t.attr_id,attrs:{label:t.attr_name}},[a("el-checkbox-group",{model:{value:t.attr_vals,callback:function(a){e.$set(t,"attr_vals",a)},expression:"item.attr_vals"}},e._l(t.attr_vals,function(e,t){return a("el-checkbox",{key:t,attrs:{border:"",label:e}})}),1)],1)}),1),a("el-tab-pane",{attrs:{name:"property",label:"商品属性"}},e._l(e.sproperty,function(t){return a("el-form-item",{key:t.attr_id,attrs:{label:t.attr_name}},[a("el-input",{model:{value:t.attr_vals,callback:function(a){e.$set(t,"attr_vals",a)},expression:"item.attr_vals"}})],1)}),1),a("el-tab-pane",{attrs:{name:"picture",label:"商品图片"}},[a("el-upload",{attrs:{action:"http://127.0.0.1:8888/api/private/v1/upload",headers:e.headers,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"list-type":"picture"}},[a("el-button",{attrs:{type:"success",plain:"",icon:"el-icon-upload"}},[e._v("上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),a("el-tab-pane",{attrs:{name:"content",label:"商品内容"}},[a("quill-editor",{model:{value:e.goodsObj.goods_introduce,callback:function(t){e.$set(e.goodsObj,"goods_introduce",t)},expression:"goodsObj.goods_introduce"}})],1)],1)],1),a("div",{staticClass:"footer"},[a("el-button",{on:{click:function(t){e.$router.go(-1)}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addGoods}},[e._v("确定")])],1),a("el-dialog",{attrs:{visible:e.dialogVisible4Preview,width:"50%"},on:{"update:visible":function(t){e.dialogVisible4Preview=t}}},[a("img",{attrs:{src:e.previewImageUrl,alt:""}})])],1)},s=[],r=(a("20d6"),a("28a5"),a("ac6a"),a("7f7f"),a("953d")),i={components:{quillEditor:r["quillEditor"]},data:function(){return{active:0,goodsObj:{goods_name:null,goods_cat:null,goods_price:null,goods_number:null,goods_weight:0,goods_introduce:null,is_promote:0,pics:[],attrs:[]},rules:{goods_name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goods_price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],goods_number:[{required:!0,message:"请输入商品数量",trigger:"blur"}],goods_cat:[{required:!0,message:"请选择商品分类",trigger:"blur"}]},options:[],props:{value:"cat_id",label:"cat_name",children:"children"},cat_id:null,dparams:[],sproperty:[],headers:{Authorization:localStorage.getItem("mytoken")},previewImageUrl:"",dialogVisible4Preview:!1}},created:function(){this.getCategoriesData()},methods:{tabClick:function(e){switch(e.name){case"base":this.active=0;break;case"params":this.active=1,this.getThreeLevelParamsOrPropertyData("many");break;case"property":this.active=2,this.getThreeLevelParamsOrPropertyData("only");break;case"picture":this.active=3;break;case"content":this.active=4;break;default:break}},getThreeLevelParamsOrPropertyData:function(e){var t=this;this.cat_id?this.$axios.get("categories/".concat(this.cat_id,"/attributes"),{params:{sel:e}}).then(function(a){"many"===e?(a.data.data.forEach(function(e){0===e.attr_vals.trim().length?e.attr_vals=[]:e.attr_vals=e.attr_vals.split(",")}),t.dparams=a.data.data):"only"===e&&(t.sproperty=a.data.data)}):this.$message.error("请选择三级分类")},getCategoriesData:function(){var e=this;this.$axios.get("categories",{params:{type:3}}).then(function(t){e.options=t.data.data})},categoryChange:function(e){e.length<3?this.$message.error("请选择三级分类"):(this.goodsObj.goods_cat=e.join(","),this.cat_id=e[e.length-1])},handleSuccess:function(e,t,a){200===e.meta.status&&this.goodsObj.pics.push({pic:e.data.tmp_path})},handlePreview:function(e){this.previewImageUrl=e.response.data.url,this.dialogVisible4Preview=!0},handleRemove:function(e,t){var a=e.response.data.tmp_path,o=this.goodsObj.pics.findIndex(function(e){return e.pic===a});this.goodsObj.pics.splice(o,1)},addGoods:function(){var e=this;this.$refs.addGoodsForm.validate(function(t){t&&(e.goodsObj.attrs=e.dparams.concat(e.sproperty),e.$axios.post("goods",e.goodsObj).then(function(t){201===t.data.meta.status&&(e.$message({message:t.data.meta.msg,type:"success"}),e.$router.go(-1))}))})}}},l=i,n=(a("b772"),a("2877")),d=Object(n["a"])(l,o,s,!1,null,"51cdac39",null);t["default"]=d.exports},b772:function(e,t,a){"use strict";var o=a("90dd"),s=a.n(o);s.a}}]);